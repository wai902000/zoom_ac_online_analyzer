<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoom Workshop 帳號在線時間分析</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
            color: #333;
        }

        #result {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
        }

        #emailInput,
        #timeInput {
            width: 48%;
            height: 150px;
        }

        #container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        textarea {
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }

        h1 {
            color: #2c3e50;
        }

        h2,
        h3 {
            color: #34495e;
        }

        p {
            margin-bottom: 20px;
        }

        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            margin: 5px 0;
        }

        .section {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
        }

        .unique,
        .duplicates {
            background-color: #e6e6fa;
        }

        .over15,
        .under15 {
            background-color: #d1ffd1;
        }

        .column {
            width: 48%;
        }

        footer {
            margin-top: 30px;
            font-size: 14px;
            text-align: center;
            color: #666;
        }
    </style>
</head>

<body>

    <h1>Zoom Workshop 帳號在線時間分析</h1>
    <h3>程序簡介：</h3>
    <p>
    <ul>
        <li>分析學生使用Zoom的在線時間</li>
        <li>排除報告中顯示重複登入的學生</li>
        <li>排除在線時間不足15分鐘的學生</li>
    </ul>

    <h3>使用說明：</h3>
    <ol>
        <li>從Zoom後台下載使用情況的.csv報告 (<a href="https://eduhk.zoom.us">https://eduhk.zoom.us</a>)</li>
        <li>把所有Email順序貼上左邊區域</li>
        <li>把所有時間(數字)順序貼上右邊區域</li>
    </ol>

    <div id="container">
        <textarea id="emailInput" placeholder="輸入Emails，每行一個，順序"></textarea>
        <textarea id="timeInput" placeholder="輸入時間（分鐘），每行一個（數字），順序"></textarea>
    </div>
    <button onclick="analyzeInput()">分析</button>
    <div id="result">
        <div class="column">
            <div class="section unique">
                <h3>不重複的Email結果 (<span id="uniqueCount"></span>)</h3>
                <ul id="uniqueList"></ul>
            </div>
            <div class="section duplicates">
                <h3>重複的Email結果 (<span id="duplicateCount"></span>)</h3>
                <ul id="duplicateList"></ul>
            </div>
        </div>
        <div class="column">
            <div class="section over15">
                <h3>在線時間超過15分鐘的不重複的Email結果 (<span id="over15Count"></span>)</h3>
                <ul id="over15List"></ul>
            </div>
            <div class="section under15">
                <h3>在線時間不足15分鐘的不重複的Email結果 (<span id="under15Count"></span>)</h3>
                <ul id="under15List"></ul>
            </div>
        </div>
    </div>

    <footer>Developer: Matt Li<br>Update: 8 Nov 2024</footer>

    <script>
        function analyzeInput() {
            const emails = document.getElementById('emailInput').value.split('\n').map(item => item.trim()).filter(item => item);
            const times = document.getElementById('timeInput').value.split('\n').map(item => parseFloat(item.trim())).filter(item => !isNaN(item));
            const emailTimeMap = {};
            const duplicates = new Set();
            const allEmails = new Set();

            emails.forEach((email, index) => {
                const time = times[index];

                if (emailTimeMap[email]) {
                    emailTimeMap[email] += time;
                    duplicates.add(email);
                } else {
                    emailTimeMap[email] = time;
                }
                allEmails.add(email);
            });

            const uniqueEmails = [...allEmails].filter(email => !duplicates.has(email));
            const over15 = [];
            const under15 = [];

            uniqueEmails.forEach(email => {
                if (emailTimeMap[email] > 15) {
                    over15.push(email);
                } else {
                    under15.push(email);
                }
            });

            displayResults(emails.length, emailTimeMap, Array.from(duplicates), uniqueEmails, over15, under15);
        }

        function displayResults(total, emailTimeMap, duplicates, uniqueEmails, over15, under15) {
            alert("輸入的總數: " + total);
            document.getElementById('uniqueCount').textContent = uniqueEmails.length;
            document.getElementById('duplicateCount').textContent = duplicates.length;
            document.getElementById('over15Count').textContent = over15.length;
            document.getElementById('under15Count').textContent = under15.length;

            document.getElementById('uniqueList').innerHTML = uniqueEmails.map(email => `<li>${email}: ${emailTimeMap[email]} 分鐘</li>`).join('');
            document.getElementById('duplicateList').innerHTML = duplicates.map(email => `<li>${email}</li>`).join('');
            document.getElementById('over15List').innerHTML = over15.map(email => `<li>${email}</li>`).join('');
            document.getElementById('under15List').innerHTML = under15.map(email => `<li>${email}: ${emailTimeMap[email]} 分鐘</li>`).join('');
        }
    </script>

</body>

</html>